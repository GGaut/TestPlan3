# Тест план

## Цель: 
- Проверить взаимодействие между Сервисом А и Сервисом В. Основное внимание уделяется асинхронной обработке, гарантированной очередности команд через AMQP и корректности изменения статусов услуг.

## Предусловия:
- Оба сервиса развернуты в тестовой среде, AMQP-канал настроен

## Критерии завершения: 
- Успешное подключение/отключение/блокирование
- Подтверждено строгое последовательное выполнение команд
- Статус услуги изменяется только после успешного ответа от Сервиса В
- Критичные проблемы устранены, известные ограничения задокументированы


## Тест кейсы:


|ID   | Название                     | Тест-кейс                                                                   | Ожидаемый результат |
|----|------------------------------|----------------------------------------------------------------------------------|---------------------------------------------------|
| TK1| Асинхронность REST | Вызвать REST‑метод при долгой обработке в Сервисе В. | Сервис А возвращает http ответ клиенту немедленно, не блокируясь ожиданием от Сервиса В. |
| TK2| Строгая очередность | Отправить две команды подряд на одну услугу. | Вторая команда уходит в AMQP только после получения подтверждения на первую. |
| TK3| Смена статуса (Позитивный) | Получить положительный ответа от Сервиса В. | Статус услуги в Сервисе А изменяется на целевой. |
| TK4| Смена статуса (Негативный) | Получить ответ с ошибкой от Сервиса В. | Статус услуги остаётся прежним; Сервис А разблокирует отправку следующей команды. |
| TK5| Изоляция запросов по услугам | Послать одновременные запросы на разные услуги. | Ожидание ответа для Услуги 1 не мешает немедленной отправке команды для Услуги 2. |
| TK6| Поведение при недоступности сервиса В | Отправить запрос, когда Сервис В отключен | Сообщения сохраняются в брокере, Сервис А корректно обрабатывает отсутствие подтверждения доставки. |
| TK7| Большое кол-во запросов | Отправить 1000+ запросов (чередуя разные) на Сервис А. | Сервис А обрабатывает все запросы без потерь. Все команды выполняются Сервисом В строго в порядке очереди. |
| TK8| Жизненный цикл команды | REST запрос → Сервис А → AMQP → Сервис В → Обработка → AMQP ответ → Сервис А → Обновление статуса | Статус обновлен, процесс прошел все узлы без ошибок. |

